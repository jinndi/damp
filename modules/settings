#!/bin/bash

settingsmenu()
{
	clear
	OPTIONMENUSETTINGS=$(whiptail --title  "$D_NAMESOFT" \
	--ok-button  " ÐžÐš [Enter] " --cancel-button  " $D_BACK [ESC] " \
	--menu  "\n $D_MENUCFG" 20 60 10 \
	"â“" " $D_LANGUAGE" \
	"â“‰" " $D_THEME" \
	3>&1 1>&2 2>&3)
	exitstatus=$?
	if [ $exitstatus = 0 ]  
	then
		case $OPTIONMENUSETTINGS in
			"â“") languagemenu ;;
			"â“‰") thememenu ;;
			*) settingsmenu ;;
		esac
	else
     	menu
	fi
	settingsmenu
}

languagemenu()
{
	clear
	OPTIONMENULANGUAGE=$(whiptail --title  "$D_NAMESOFT" \
	--ok-button  " ÐžÐš [Enter] " --cancel-button  " $D_BACK [ESC] " \
	--menu  "\n $D_LANGUAGESELECT" 20 60 10 \
	"ðŸ‡¬ðŸ‡§" " $D_ENGLISH" \
	"ðŸ‡·ðŸ‡º" " $D_RUSSIAN" \
	3>&1 1>&2 2>&3)
	exitstatus=$?
	if [ $exitstatus = 0 ]  
	then
		case $OPTIONMENULANGUAGE in
			"ðŸ‡¬ðŸ‡§") languagechange "en" ;;
			"ðŸ‡·ðŸ‡º") languagechange "ru" ;;
			*) settingsmenu ;;
		esac
	else
     	settingsmenu
	fi
	settingsmenu
}

languagechange()
{
	clear
	wrun + "$D_CHANGELANGUAGE"
	changeconf "^\s*language" "$rootdir/DAMP.conf" "language=$1" &>/dev/null
	sleep 3
	wrun -
	initcfg
	clear
	print_status "$D_LANGUAGECHANGE $1"
}

thememenu()
{
	clear
	OPTIONMENUTHEME=$(whiptail --title  "$D_NAMESOFT" \
	--ok-button  " ÐžÐš [Enter] " --cancel-button  " $D_BACK [ESC] " \
	--menu  "\n $D_THEMESELECT" 20 60 10 \
	"â’¹" " $D_DEFAULT" \
	"â’·" " $D_BLACK" \
	"â’¼" " $D_GREEN" \
	"â“" " $D_LIGHT" \
	3>&1 1>&2 2>&3)
	exitstatus=$?
	if [ $exitstatus = 0 ]  
	then
		case $OPTIONMENUTHEME in
			"â’¹") themechange "default" ;;
			"â’·") themechange "black" ;;
			"â’¼") themechange "green" ;;
			"â“") themechange "light" ;;
			*) settingsmenu ;;
		esac
	else
     	settingsmenu
	fi
	settingsmenu	
}

themechange()
{
	clear
	wrun + "$D_CHANGETHEME"
	changeconf "^\s*theme" "$rootdir/DAMP.conf" "theme=$1" &>/dev/null
	sleep 3
	wrun -
	initcfg
	clear
	print_status "$D_THEMECHANGE $1"
}
